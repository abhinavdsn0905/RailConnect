{% extends "adminpanel/admin_base.html" %}
{% block page_title %}Dashboard{% endblock %}
{% block n_dash %}active{% endblock %}
{% block topbar_title %}Dashboard{% endblock %}
{% block topbar_badge %}<span class="topbar-pill">Overview</span>{% endblock %}

{% block content %}

<div class="ph">
    <div class="ph-title">ğŸš† Network Overview</div>
    <div class="ph-sub">Real-time statistics across the entire rail system</div>
</div>

<!-- STATS -->
<div class="stats-grid">
    <div class="sc">
        <div class="sc-label">Total Users</div>
        <div class="sc-value">{{ total_users }}</div>
    </div>
    <div class="sc green">
        <div class="sc-label">Active Trains</div>
        <div class="sc-value">{{ total_trains }}</div>
    </div>
    <div class="sc amber">
        <div class="sc-label">Today's Bookings</div>
        <div class="sc-value">{{ today_bookings }}</div>
    </div>
    <div class="sc red">
        <div class="sc-label">Total Revenue (â‚¹)</div>
        <div class="sc-value">{{ total_revenue|floatformat:0 }}</div>
    </div>
</div>

<!-- QUICK LINKS -->
<div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px,1fr)); gap:12px; margin-bottom:24px;">
    <a href="{% url 'adminpanel:train_list' %}" style="background:var(--c-card); border:1px solid var(--c-border); border-radius:var(--radius-md); padding:16px 20px; display:flex; align-items:center; gap:12px;" onmouseover="this.style.background='var(--c-hover)'" onmouseout="this.style.background='var(--c-card)'">
        <span style="font-size:22px;">ğŸš‚</span>
        <span style="font-size:13px; font-weight:600; color:var(--c-text);">Manage Trains</span>
    </a>
    <a href="{% url 'adminpanel:station_list' %}" style="background:var(--c-card); border:1px solid var(--c-border); border-radius:var(--radius-md); padding:16px 20px; display:flex; align-items:center; gap:12px;" onmouseover="this.style.background='var(--c-hover)'" onmouseout="this.style.background='var(--c-card)'">
        <span style="font-size:22px;">ğŸ›ï¸</span>
        <span style="font-size:13px; font-weight:600; color:var(--c-text);">Manage Stations</span>
    </a>
    <a href="{% url 'adminpanel:booking_list' %}" style="background:var(--c-card); border:1px solid var(--c-border); border-radius:var(--radius-md); padding:16px 20px; display:flex; align-items:center; gap:12px;" onmouseover="this.style.background='var(--c-hover)'" onmouseout="this.style.background='var(--c-card)'">
        <span style="font-size:22px;">ğŸ«</span>
        <span style="font-size:13px; font-weight:600; color:var(--c-text);">All Bookings</span>
    </a>
    <a href="{% url 'adminpanel:user_list' %}" style="background:var(--c-card); border:1px solid var(--c-border); border-radius:var(--radius-md); padding:16px 20px; display:flex; align-items:center; gap:12px;" onmouseover="this.style.background='var(--c-hover)'" onmouseout="this.style.background='var(--c-card)'">
        <span style="font-size:22px;">ğŸ‘¥</span>
        <span style="font-size:13px; font-weight:600; color:var(--c-text);">Users</span>
    </a>
    <a href="{% url 'adminpanel:reports' %}" style="background:var(--c-card); border:1px solid var(--c-border); border-radius:var(--radius-md); padding:16px 20px; display:flex; align-items:center; gap:12px;" onmouseover="this.style.background='var(--c-hover)'" onmouseout="this.style.background='var(--c-card)'">
        <span style="font-size:22px;">ğŸ“ˆ</span>
        <span style="font-size:13px; font-weight:600; color:var(--c-text);">Reports</span>
    </a>
</div>

<!-- RECENT BOOKINGS TABLE -->
<div class="t-wrap">
    <div class="t-header">
        <span class="t-header-title">ğŸ•’ Recent Bookings</span>
        <a href="{% url 'adminpanel:booking_list' %}" class="btn btn-ghost btn-sm">View All â†’</a>
    </div>

    {% if recent_bookings %}
    <table>
        <thead>
            <tr>
                <th>PNR</th>
                <th>Passenger</th>
                <th>Train</th>
                <th>Journey</th>
                <th>Travel Date</th>
                <th>Seats</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
        {% for booking in recent_bookings %}
            <tr>
                <td class="mono-cell">{{ booking.pnr }}</td>
                <td><strong>{{ booking.username }}</strong></td>
                <td class="dim-cell">{{ booking.train.train_name }}</td>
                <td class="dim-cell" style="white-space:nowrap;">
                    {% if booking.from_station and booking.to_station %}
                        {{ booking.from_station.name }} â†’ {{ booking.to_station.name }}
                    {% else %}â€”{% endif %}
                </td>
                <td class="dim-cell">{{ booking.travel_date|date:"M d, Y" }}</td>
                <td>{{ booking.passengers }}</td>
                <td><span class="badge badge-green">â‚¹{{ booking.total_price }}</span></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">
        <div class="empty-icon">ğŸ«</div>
        <p>No bookings yet.</p>
    </div>
    {% endif %}
</div>

{% endblock %}